<section>
<div class="traits">
    <h1 class="h1">Traits:</h1>
    <div style="overflow-y: auto;">
        {{#each data.traits as |trait|}}
        <div class="flexbox">
            <label class="label trait-label" for="data.traits.{{@key}}.level">{{trait.name}}</label>
            <input style="display:inline-block; width: 12%; text-align: center;" class="input" type="text" name="data.traits.{{@key}}.level" value="{{trait.level}}"/>
            <input style="display:inline-block; width: 12%; text-align: center;" class="input" type="text" name="data.traits.{{@key}}.die_type" value="{{trait.die_type}}"/>
            <label style="font-size: large; font-weight: bold; padding-top: 2px;; float: right;" for="data.traits.{{@key}}.modifier">+</label>
            <input style="display:inline-block; width: 12%; text-align: center;" class="input" type="text" name="data.traits.{{@key}}.modifier" value="{{trait.modifier}}"/>
            <a style="margin-left: 20px; margin-right: 21px; margin-top: 5px" id="{{@key}}_roll" title="Roll {{this.name}}"><i class="fas fa-dice-d20"></i></a>
            <script>
                function callback() {
                    let content = "{{trait.name}}: [[{{trait.level}}{{trait.die_type}}ex + {{trait.modifier}}]]" 
                    ChatMessage.create({
                        content: content
                    });
                }
                {{@key}}_roll.addEventListener('click', callback);
            </script>
        </div>
        <div>
            <table>
                <tr>
                    <th class="skill-name">{{localize "dc.skill_labels.name"}}</th>
                    <th class="skill-input">{{localize "dc.skill_labels.level"}}</th>
                    <th class="skill-input">{{localize "dc.skill_labels.modifier"}}</th>
                    <th>{{localize "dc.skill_labels.roll"}}</th>
                </tr>
                {{#each skills as |skill|}}
                <tr>
                    <td><input style="display:inline-block; text-align: left;" class="input" type="text" name="data.traits.{{@../key}}.skills.{{@key}}.name" value="{{this.name}}"/></td>
                    <td><input style="display:inline-block; text-align: center;" class="input" type="text" name="data.traits.{{@../key}}.skills.{{@key}}.level" value="{{this.level}}"/></td>
                    <td><input style="display:inline-block; text-align: center;" class="input" type="text" name="data.traits.{{@../key}}.skills.{{@key}}.modifier" value="{{this.modifier}}"/></td>
                    <td><a style="margin-left: 20px;  margin-right: 20px;" id="{{@key}}_roll"><i class="fas fa-dice-d20" title="Roll {{this.name}}"></i></a></td>
                    <script>
                        function callback() {
                            let content = "";
                            console.log("Log Data: {{data.wound_modifier}}");
                            let skill_level = parseInt("{{this.level}}");
                            if (skill_level > 0){
                                content = `
                                    <div>
                                        <h3 style="text-align:center">{{this.name}}</h3>
                                        <p style="text-align:center">[[{{this.level}}{{trait.die_type}}ex + {{this.modifier}} + {{data.wound_modifier}}]]</p>
                                    </div>
                                `;
                            }else{
                                content = `
                                    <div>
                                        <h3 style="text-align:center">{{this.name}}</h3>
                                        <p style="text-align:center">[[{{trait.level}}{{trait.die_type}}ex + {{this.modifier}} + {{data.wound_modifier}}]]</p>
                                    </div>
                                `;
                            };
                            ChatMessage.create({
                                content: content
                            });
                        }
                        {{@key}}_roll.addEventListener('click', callback);
                    </script>
                </tr>
                {{/each}}
            </table>
        </div>
        {{/each}}
    </div>
</div>
</section>